

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Atomic swap example &mdash; Clove  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Transaction refunds" href="refund.html" />
    <link rel="prev" title="Clove" href="README.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Clove
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Clove </a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Atomic swap example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bitcoin-based-networks">Bitcoin based networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assumptions">Assumptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cryptoid-api-key">Cryptoid API key</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etherscan-api-key">Etherscan API key</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wallets-setup">1. Wallets setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-b1">2. Communication (b1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alice-is-initializing-an-atomic-swap-transaction-using-monacoin">3. Alice is initializing an atomic swap transaction using Monacoin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-b2">4. Communication (b2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contract-audit-mona">5. Contract audit (MONA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#participation-ltc">6. Participation (LTC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-b3">7. Communication (b3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contract-audit-ltc">8. Contract audit (LTC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#first-redeem-transaction-ltc">9. First redeem transaction (LTC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secret-capture-ltc">10. Secret capture (LTC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-redeem-transaction-mona">11. Second redeem transaction (MONA)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ethereum-testnet">Ethereum Testnet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup">1. Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-e1">2. Communication (e1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#token-approval">3. Token approval</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alice-is-initializing-an-atomic-swap-transaction-using-bbt-token">4. Alice is initializing an atomic swap transaction using BBT token</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-e2">5. Communication (e2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contract-audit-bbt-token">6. Contract audit (BBT token)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#participation-eth-testnet">7. Participation (ETH-TESTNET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-e3">8. Communication (e3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contract-audit-eth-testnet">9. Contract audit (ETH-TESTNET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#first-redeem-transaction-eth-testnet">10. First redeem transaction (ETH-TESTNET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secret-capture-eth-testnet">11. Secret capture (ETH-TESTNET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-redeem-transaction-bbt-token">12. Second redeem transaction (BBT token)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="refund.html">Transaction refunds</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips-and-tricks.html">Tips &amp; Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Clove</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Atomic swap example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atomic-swap-example">
<span id="atomic-swap-example"></span><h1>Atomic swap example<a class="headerlink" href="#atomic-swap-example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bitcoin-based-networks">
<span id="bitcoin-based-networks"></span><h2>Bitcoin based networks<a class="headerlink" href="#bitcoin-based-networks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="assumptions">
<span id="assumptions"></span><h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Alice has over 0.03 monacoins and wants to buy 0.001 litecoins</li>
<li>Alice doesn’t have a litecoin wallet</li>
<li>Bob has over 0.001 litecoins and wants to buy around 0.03 monacoin</li>
<li>Bob has a monacoin wallet</li>
</ul>
<p>(2018-10-04) Exchange rate: 0.001 litecoins is 0.030 monacoin</p>
<div class="section" id="cryptoid-api-key">
<span id="cryptoid-api-key"></span><h4>Cryptoid API key<a class="headerlink" href="#cryptoid-api-key" title="Permalink to this headline">¶</a></h4>
<p>For operations on networks supported by <code class="docutils literal notranslate"><span class="pre">chainz.cryptoid.info</span></code> API a <a class="reference external" href="https://chainz.cryptoid.info/api.key.dws">free API key</a> is needed. This key has to be setup as a environment variable under the <code class="docutils literal notranslate"><span class="pre">CRYPTOID_API_KEY</span></code> key.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export CRYPTOID_API_KEY=YOUR_API_KEY
</pre></div>
</div>
</div>
<div class="section" id="etherscan-api-key">
<span id="etherscan-api-key"></span><h4>Etherscan API key<a class="headerlink" href="#etherscan-api-key" title="Permalink to this headline">¶</a></h4>
<p>For operations on Etherscan API (e.q. <code class="docutils literal notranslate"><span class="pre">find_redeem_transaction</span></code>) a <a class="reference external" href="https://etherscan.io/myapikey">free API key</a> is needed. This key has to be setup as a environment variable under the <code class="docutils literal notranslate"><span class="pre">ETHERSCAN_API_KEY</span></code> key.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export ETHERSCAN_API_KEY=YOUR_API_KEY
</pre></div>
</div>
</div>
</div>
<div class="section" id="wallets-setup">
<span id="wallets-setup"></span><h3>1. Wallets setup<a class="headerlink" href="#wallets-setup" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] has to create a new litecoin wallet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clove.network</span> <span class="k">import</span> <span class="n">Litecoin</span>

<span class="n">ltc_network</span> <span class="o">=</span> <span class="n">Litecoin</span><span class="p">()</span>

<span class="n">alice_ltc_wallet</span> <span class="o">=</span> <span class="n">ltc_network</span><span class="o">.</span><span class="n">get_new_wallet</span><span class="p">()</span>

<span class="n">alice_ltc_wallet</span><span class="o">.</span><span class="n">address</span>
<span class="s1">&#39;LXRAXRgPo84p58746zaBXUFFevCTYBPxgb&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://chainz.cryptoid.info/ltc/address.dws?LXRAXRgPo84p58746zaBXUFFevCTYBPxgb.htm">Check address on block explorer</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_ltc_wallet</span><span class="o">.</span><span class="n">get_private_key</span><span class="p">()</span>
<span class="c1"># returns private key; The one below is fake, because of obvious security reasons.</span>
<span class="s1">&#39;L15kFZg4MdoX2kqXEeEZMjbbVEdZzt1zL2vU59ynrtEf6GB16B3c&#39;</span>
</pre></div>
</div>
<p>[<strong>Alice</strong>] has to prepare her monacoin wallet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clove.network</span> <span class="k">import</span> <span class="n">Monacoin</span>

<span class="n">mona_network</span> <span class="o">=</span> <span class="n">Monacoin</span><span class="p">()</span>

<span class="c1"># Alice provides hers private key. The one below is fake, because of obvious security reasons.</span>
<span class="n">alice_mona_wallet</span> <span class="o">=</span> <span class="n">mona_network</span><span class="o">.</span><span class="n">get_wallet</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="s1">&#39;cSYq9JswNm79GUdyz6TiNKajRTiJEKgv4RxSWGthP3SmUHiX9WKe&#39;</span><span class="p">)</span>

<span class="n">alice_mona_wallet</span><span class="o">.</span><span class="n">address</span>
<span class="s1">&#39;MPLx6eJS41da9bPsLLkHo35uY6KsHu7dXP&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://insight.electrum-mona.org/insight/address/MPLx6eJS41da9bPsLLkHo35uY6KsHu7dXP">Check addres on block explorer</a></p>
<p>[<strong>Bob</strong>] can use his existing monacoin wallet by passing his private key</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clove.network</span> <span class="k">import</span> <span class="n">Monacoin</span>

<span class="n">mona_network</span> <span class="o">=</span> <span class="n">Monacoin</span><span class="p">()</span>

<span class="c1"># Bob provides his private key. The one below is fake, because of obvious security reasons.</span>
<span class="n">bob_mona_wallet</span> <span class="o">=</span> <span class="n">mona_network</span><span class="o">.</span><span class="n">get_wallet</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="s1">&#39;cRoFBWMvcLXrLsYFt794NRBEPUgMLf5AmnJ7VQwiEenc34z7zSpK&#39;</span><span class="p">)</span>

<span class="n">bob_mona_wallet</span><span class="o">.</span><span class="n">address</span>
<span class="s1">&#39;MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://insight.electrum-mona.org/insight/address/MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye">Check addres on block explorer</a></p>
<p>[<strong>Bob</strong>] has to prepare his litecoin wallet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clove.network</span> <span class="k">import</span> <span class="n">Litecoin</span>

<span class="n">ltc_network</span> <span class="o">=</span> <span class="n">Litecoin</span><span class="p">()</span>

<span class="c1"># Bob provides his private key. The one below is fake, because of obvious security reasons.</span>
<span class="n">bob_ltc_wallet</span> <span class="o">=</span> <span class="n">ltc_network</span><span class="o">.</span><span class="n">get_wallet</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="s1">&#39;cTVuBqcjryCdHiCfFxkY5ycNPH2RYNrbmgrTVXBsLKG8xR2My3j2&#39;</span><span class="p">)</span>

<span class="n">bob_ltc_wallet</span><span class="o">.</span><span class="n">address</span>
<span class="s1">&#39;LUAn5PWmsPavgz32mGkqsUuAKncftS37Jq&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://chainz.cryptoid.info/ltc/address.dws?LUAn5PWmsPavgz32mGkqsUuAKncftS37Jq.htm">Check addres on block explorer</a></p>
</div>
<div class="section" id="communication-b1">
<span id="communication-b1"></span><h3>2. Communication (b1)<a class="headerlink" href="#communication-b1" title="Permalink to this headline">¶</a></h3>
<p>Alice and Bob exchange their wallet addresses.</p>
<p>[<strong>Alice</strong>]’s console input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_mona_address</span> <span class="o">=</span> <span class="s1">&#39;MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye&#39;</span>
<span class="n">bob_ltc_address</span> <span class="o">=</span> <span class="s1">&#39;LUAn5PWmsPavgz32mGkqsUuAKncftS37Jq&#39;</span>
</pre></div>
</div>
<p>[<strong>Bob</strong>]’s console input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_mona_address</span> <span class="o">=</span> <span class="s1">&#39;MPLx6eJS41da9bPsLLkHo35uY6KsHu7dXP&#39;</span>
<span class="n">alice_ltc_address</span> <span class="o">=</span> <span class="s1">&#39;LXRAXRgPo84p58746zaBXUFFevCTYBPxgb&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="alice-is-initializing-an-atomic-swap-transaction-using-monacoin">
<span id="alice-is-initializing-an-atomic-swap-transaction-using-monacoin"></span><h3>3. Alice is initializing an atomic swap transaction using Monacoin<a class="headerlink" href="#alice-is-initializing-an-atomic-swap-transaction-using-monacoin" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] has to prepare an atomic swap transaction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initial_transaction</span> <span class="o">=</span> <span class="n">mona_network</span><span class="o">.</span><span class="n">atomic_swap</span><span class="p">(</span>
    <span class="n">sender_address</span><span class="o">=</span><span class="n">alice_mona_wallet</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
    <span class="n">recipient_address</span><span class="o">=</span><span class="n">bob_mona_address</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mf">0.030</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">initial_transaction</span><span class="o">.</span><span class="n">add_fee_and_sign</span><span class="p">(</span><span class="n">alice_mona_wallet</span><span class="p">)</span>

<span class="n">initial_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract&#39;</span><span class="p">:</span> <span class="s1">&#39;63a61450314a793bf317665ecdc54c2e843bb106aeee158876a914fbed00c1502fded3dfa2524f8672ee013bb3f28f670465bab85bb17576a914a96a92963b7a65ac904875cfa5d535b3115888276888ac&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;PHVjh4aEgaY5DucNGT6xoFjLD1LAqo9SMu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contract_transaction&#39;</span><span class="p">:</span> <span class="s1">&#39;0100000001d4a61b33e849c8df64a2c839b878437a0ef055887ff0bf4279b8a805a2043b69010000006b483045022100a038a71fc3218c67e64804171b8a311397872fff51c85cbef81170570915946b02202385c01f3c4b06416108b6b856ca4f112e79ed74bc36766df4d994a696a7479401210240917aa65f12d8051abae7e8e98eea3b085a766a2dd7bd7f71c8121304cca2980000000002c0c62d000000000017a91461b1cbc5cd1b50e69e1c895d6cbcc94376c4ab3c87345e1401000000001976a914a96a92963b7a65ac904875cfa5d535b31158882788ac00000000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee&#39;</span><span class="p">:</span> <span class="mf">0.00017655</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb&#39;</span><span class="p">:</span> <span class="mf">0.0007881781818181818</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00078818 MONA / 1 kB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00017655 MONA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">851140</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MPLx6eJS41da9bPsLLkHo35uY6KsHu7dXP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="s1">&#39;c480afb333623864901c968022a07dd93fe3c06f5684ea728b8113e17fa91bd9&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;50314a793bf317665ecdc54c2e843bb106aeee15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">224</span><span class="p">,</span>
 <span class="s1">&#39;size_text&#39;</span><span class="p">:</span> <span class="s1">&#39;224 bytes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://insight.electrum-mona.org/insight/tx/a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.03000000 MONA&#39;</span><span class="p">}</span>

 <span class="n">initial_transaction</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
 <span class="s1">&#39;a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span>
</pre></div>
</div>
<p>We can check if the transaction exists by using the <code class="docutils literal notranslate"><span class="pre">transaction_link</span></code> from <code class="docutils literal notranslate"><span class="pre">show_details()</span></code> or by calling the <code class="docutils literal notranslate"><span class="pre">mona_network.get_transaction(initial_transaction.address)</span></code>.</p>
<p><a class="reference external" href="https://insight.electrum-mona.org/insight/tx/a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473">Check transaction in block explorer</a></p>
</div>
<div class="section" id="communication-b2">
<span id="communication-b2"></span><h3>4. Communication (b2)<a class="headerlink" href="#communication-b2" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] sends her transaction address <code class="docutils literal notranslate"><span class="pre">a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473</span></code> and contract <code class="docutils literal notranslate"><span class="pre">63a61450314a793bf317665ecdc54c2e843bb106aeee158876a914fbed00c1502fded3dfa2524f8672ee013bb3f28f670465bab85bb17576a914a96a92963b7a65ac904875cfa5d535b3115888276888ac</span></code> to Bob, so he can audit the transaction.</p>
</div>
<div class="section" id="contract-audit-mona">
<span id="contract-audit-mona"></span><h3>5. Contract audit (MONA)<a class="headerlink" href="#contract-audit-mona" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] needs to create a contract in network of coins he wants to receive (i.e. Alice’s network), in our case in Monacoin network.
And also at this point Bob should validate if the data returned in the contract is correct.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_contract</span> <span class="o">=</span> <span class="n">mona_network</span><span class="o">.</span><span class="n">audit_contract</span><span class="p">(</span>
    <span class="n">contract</span><span class="o">=</span><span class="s1">&#39;63a61450314a793bf317665ecdc54c2e843bb106aeee158876a914fbed00c1502fded3dfa2524f8672ee013bb3f28f670465bab85bb17576a914a96a92963b7a65ac904875cfa5d535b3115888276888ac&#39;</span><span class="p">,</span>
    <span class="n">transaction_address</span><span class="o">=</span><span class="s1">&#39;a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">alice_contract</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;confirmations&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
 <span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;PHVjh4aEgaY5DucNGT6xoFjLD1LAqo9SMu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MPLx6eJS41da9bPsLLkHo35uY6KsHu7dXP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;50314a793bf317665ecdc54c2e843bb106aeee15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://insight.electrum-mona.org/insight/tx/a019e444e331ec843ae2d98b87073884e695dd08be06ba91f335af89dbe45473&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.03000000 MONA&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="participation-ltc">
<span id="participation-ltc"></span><h3>6. Participation (LTC)<a class="headerlink" href="#participation-ltc" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] has to create a parallel transaction from point 3 but in his network (i.e. Litecoin network). We call it  a <code class="docutils literal notranslate"><span class="pre">participate_transaction</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">participate_transaction</span> <span class="o">=</span> <span class="n">alice_contract</span><span class="o">.</span><span class="n">participate</span><span class="p">(</span>
    <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;LTC&#39;</span><span class="p">,</span>
    <span class="n">sender_address</span><span class="o">=</span><span class="n">bob_ltc_wallet</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
    <span class="n">recipient_address</span><span class="o">=</span><span class="n">alice_ltc_address</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">participate_transaction</span><span class="o">.</span><span class="n">add_fee_and_sign</span><span class="p">(</span><span class="n">bob_ltc_wallet</span><span class="p">)</span>

<span class="n">participate_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract&#39;</span><span class="p">:</span> <span class="s1">&#39;63a61450314a793bf317665ecdc54c2e843bb106aeee158876a91485c0522f6e23beb11cc3d066cd20ed732648a4e66704926db75bb17576a914621f617c765c3caa5ce1bb67f6a3e51382b8da296888ac&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MSRzh2WrJ7o3ceSvCTxsuMk6i69kpWrtwS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;contract_transaction&#39;</span><span class="p">:</span> <span class="s1">&#39;0100000001741a87828215c8bfeef3cfa70925ce91bca806f4f3dd931092f3b1727692504e000000008b483045022100bbd11530d3ea9cdf7b6385ff9aa884acdc04c8cdc96e182360ef5e69fb270512022054c0c5d2024878324af45b7ca5d81b19099e847976a0bbba2d23741a30f6eab401410431ab07973bbb5dbc6b7422fc7322abb5df15f77694c0b15b09a325996af47ddd887c7eaa72c656a71fcb333068956de7b3e2f15deaafc1d9285d779ca1b6a3f60000000002a08601000000000017a914cb4731b2c83362dcd05bba45e5f0ab8cd8642e4a876b730200000000001976a914621f617c765c3caa5ce1bb67f6a3e51382b8da2988ac00000000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee&#39;</span><span class="p">:</span> <span class="mf">2.146e-05</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb&#39;</span><span class="p">:</span> <span class="mf">8.415e-05</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00008415 LTC / 1 kB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00002146 LTC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">8070</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;LXRAXRgPo84p58746zaBXUFFevCTYBPxgb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;LUAn5PWmsPavgz32mGkqsUuAKncftS37Jq&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;50314a793bf317665ecdc54c2e843bb106aeee15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
 <span class="s1">&#39;size_text&#39;</span><span class="p">:</span> <span class="s1">&#39;256 bytes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://chainz.cryptoid.info/ltc/tx.dws?09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa.htm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00100000 LTC&#39;</span><span class="p">}</span>

<span class="n">participate_transaction</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://chainz.cryptoid.info/ltc/tx.dws?09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa.htm">Check transaction on block explorer</a></p>
</div>
<div class="section" id="communication-b3">
<span id="communication-b3"></span><h3>7. Communication (b3)<a class="headerlink" href="#communication-b3" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] sends his transaction address <code class="docutils literal notranslate"><span class="pre">09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa</span></code> and contract <code class="docutils literal notranslate"><span class="pre">63a61450314a793bf317665ecdc54c2e843bb106aeee158876a91485c0522f6e23beb11cc3d066cd20ed732648a4e66704926db75bb17576a914621f617c765c3caa5ce1bb67f6a3e51382b8da296888ac</span></code> to Alice.</p>
</div>
<div class="section" id="contract-audit-ltc">
<span id="contract-audit-ltc"></span><h3>8. Contract audit (LTC)<a class="headerlink" href="#contract-audit-ltc" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] needs to audit the contract in network of coins she wants to receive (i.e. Bob’s network), in our case on the Litecoin network.
And also at this point Alice should validate if the data returned in the contract is correct</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_contract</span> <span class="o">=</span> <span class="n">ltc_network</span><span class="o">.</span><span class="n">audit_contract</span><span class="p">(</span>
    <span class="n">contract</span><span class="o">=</span><span class="s1">&#39;63a61450314a793bf317665ecdc54c2e843bb106aeee158876a91485c0522f6e23beb11cc3d066cd20ed732648a4e66704926db75bb17576a914621f617c765c3caa5ce1bb67f6a3e51382b8da296888ac&#39;</span><span class="p">,</span>
    <span class="n">transaction_address</span><span class="o">=</span><span class="s1">&#39;09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>[<strong>Alice</strong>] can check the details of the contract</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_contract</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;confirmations&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MSRzh2WrJ7o3ceSvCTxsuMk6i69kpWrtwS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;LXRAXRgPo84p58746zaBXUFFevCTYBPxgb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;LUAn5PWmsPavgz32mGkqsUuAKncftS37Jq&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;50314a793bf317665ecdc54c2e843bb106aeee15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://chainz.cryptoid.info/ltc/tx.dws?09a60dc3fafe6ba058b2a140457df1c3b446602595d47deed641cb635ffd25aa.htm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00100000 LTC&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="first-redeem-transaction-ltc">
<span id="first-redeem-transaction-ltc"></span><h3>9. First redeem transaction (LTC)<a class="headerlink" href="#first-redeem-transaction-ltc" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] can now collect coins she wants, thus she creates redeem transaction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_redeem</span> <span class="o">=</span> <span class="n">bob_contract</span><span class="o">.</span><span class="n">redeem</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">initial_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()[</span><span class="s1">&#39;secret&#39;</span><span class="p">],</span> <span class="n">wallet</span><span class="o">=</span><span class="n">alice_ltc_wallet</span><span class="p">)</span>
<span class="n">alice_redeem</span><span class="o">.</span><span class="n">add_fee_and_sign</span><span class="p">()</span>

<span class="n">alice_redeem</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;fee&#39;</span><span class="p">:</span> <span class="mf">2.886e-05</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb&#39;</span><span class="p">:</span> <span class="mf">8.415e-05</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00008415 LTC / 1 kB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00002886 LTC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;LXRAXRgPo84p58746zaBXUFFevCTYBPxgb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">342</span><span class="p">,</span>
 <span class="s1">&#39;size_text&#39;</span><span class="p">:</span> <span class="s1">&#39;342 bytes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction&#39;</span><span class="p">:</span> <span class="s1">&#39;0100000001aa25fd5f63cb41d6ee7dd495256046b4c3f17d4540a1b258a06bfefac30da60900000000fdff0047304402201c8869d359b5599ecffd51a96f0a8799392c98c4e15242762ba455e37b1f5d6302203f2974e9afc8d641f9363167df48e5a845a8deba1381bf5a1b549ac04718a1ac01410459cdb91eb7298bc2578dc4e7ac2109ac3cfd9dc9818795c5583e720d2114d540724bf26b4541f683ff51968db627a04eecd1f5cff615b6350dad5fb595f8adf420c480afb333623864901c968022a07dd93fe3c06f5684ea728b8113e17fa91bd9514c5163a61450314a793bf317665ecdc54c2e843bb106aeee158876a91485c0522f6e23beb11cc3d066cd20ed732648a4e66704926db75bb17576a914621f617c765c3caa5ce1bb67f6a3e51382b8da296888ac00000000015a7b0100000000001976a91485c0522f6e23beb11cc3d066cd20ed732648a4e688ac00000000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;a5c027027c695f403fe570850e35ffd44bb28479ecaaee039372015fe0aae7b2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://chainz.cryptoid.info/ltc/tx.dws?a5c027027c695f403fe570850e35ffd44bb28479ecaaee039372015fe0aae7b2.htm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00100000 LTC&#39;</span><span class="p">}</span>

<span class="n">alice_redeem</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;a5c027027c695f403fe570850e35ffd44bb28479ecaaee039372015fe0aae7b2&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://chainz.cryptoid.info/ltc/tx.dws?a5c027027c695f403fe570850e35ffd44bb28479ecaaee039372015fe0aae7b2.htm">Check transaction in block explorer</a></p>
<p>[<strong>Alice</strong>] should get litecoins just after redeem transaction is published.</p>
</div>
<div class="section" id="secret-capture-ltc">
<span id="secret-capture-ltc"></span><h3>10. Secret capture (LTC)<a class="headerlink" href="#secret-capture-ltc" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] should check if his contract has been already redeemed to be able to extract the secret from the redeem transaction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contract_address</span> <span class="o">=</span> <span class="n">participate_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()[</span><span class="s1">&#39;contract_address&#39;</span><span class="p">]</span>
<span class="n">secret</span> <span class="o">=</span> <span class="n">ltc_network</span><span class="o">.</span><span class="n">extract_secret_from_redeem_transaction</span><span class="p">(</span><span class="n">contract_address</span><span class="p">)</span>
<span class="n">secret</span>
<span class="s1">&#39;c480afb333623864901c968022a07dd93fe3c06f5684ea728b8113e17fa91bd9&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="second-redeem-transaction-mona">
<span id="second-redeem-transaction-mona"></span><h3>11. Second redeem transaction (MONA)<a class="headerlink" href="#second-redeem-transaction-mona" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] can now collect coins he wants, thus he creates redeem transaction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_redeem</span> <span class="o">=</span> <span class="n">alice_contract</span><span class="o">.</span><span class="n">redeem</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">secret</span><span class="p">,</span> <span class="n">wallet</span><span class="o">=</span><span class="n">bob_mona_wallet</span><span class="p">)</span>

<span class="n">bob_redeem</span><span class="o">.</span><span class="n">add_fee_and_sign</span><span class="p">()</span>

<span class="n">bob_redeem</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;fee&#39;</span><span class="p">:</span> <span class="mf">0.00014787</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb&#39;</span><span class="p">:</span> <span class="mf">0.0004801077777777778</span><span class="p">,</span>
 <span class="s1">&#39;fee_per_kb_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00048011 MONA / 1 kB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fee_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00014787 MONA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;MWsDkqHLonS5KfbRnRu3feByD9qkuj44Ye&#39;</span><span class="p">,</span>
 <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">309</span><span class="p">,</span>
 <span class="s1">&#39;size_text&#39;</span><span class="p">:</span> <span class="s1">&#39;309 bytes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction&#39;</span><span class="p">:</span> <span class="s1">&#39;01000000017354e4db89af35f391ba06be08dd95e6843807878bd9e23a84ec31e344e419a000000000e0483045022100d3e8f684e2bcdfe43a3f8ea6f6f77a97c7ebfe5e6ba3f280a078f18967d2b43a02204b40068e347e607438c893b83439099bf150f962a5b1009709d513732b4c6f0e0121028164de7b41f30fafac11350539035b38304def75c448d24178b6bc9ac902e95e20c480afb333623864901c968022a07dd93fe3c06f5684ea728b8113e17fa91bd9514c5163a61450314a793bf317665ecdc54c2e843bb106aeee158876a914fbed00c1502fded3dfa2524f8672ee013bb3f28f670465bab85bb17576a914a96a92963b7a65ac904875cfa5d535b3115888276888ac0000000001fd8c2d00000000001976a914fbed00c1502fded3dfa2524f8672ee013bb3f28f88ac00000000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;5d6972cbb7ec034003e7880302d69b2d83b54eb89193a606ff26d7fbb253bba1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_link&#39;</span><span class="p">:</span> <span class="s1">&#39;https://insight.electrum-mona.org/insight/tx/5d6972cbb7ec034003e7880302d69b2d83b54eb89193a606ff26d7fbb253bba1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.03000000 MONA&#39;</span><span class="p">}</span>

<span class="n">bob_redeem</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;5d6972cbb7ec034003e7880302d69b2d83b54eb89193a606ff26d7fbb253bba1&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://insight.electrum-mona.org/insight/tx/5d6972cbb7ec034003e7880302d69b2d83b54eb89193a606ff26d7fbb253bba1">Check transaction in block explorer</a></p>
<p>[<strong>Bob</strong>] should get monacoins just after redeem transaction is published.</p>
</div>
</div>
<div class="section" id="ethereum-testnet">
<span id="ethereum-testnet"></span><h2>Ethereum Testnet<a class="headerlink" href="#ethereum-testnet" title="Permalink to this headline">¶</a></h2>
<div class="section" id="assumptions">
<span id="id1"></span><h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Alice wants to buy 0.5 ETH for 1000 Blockbusters Test tokens in Ethereum Kovan Testnet</li>
<li>Bob wants to buy 1000 Blockbusters Test tokens for 0.5 ETH in Ethereum Kovan Testnet</li>
<li>Both Alice and Bob have wallets in Ethereum Kovan network</li>
</ul>
</div>
<div class="section" id="setup">
<span id="setup"></span><h3>1. Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<p>Alice should initialize the network object, set her address, private key, amount of tokens to be swapped and the address of the token.</p>
<p>[<strong>Alice</strong>]’s console input:
from clove.network import EthereumTestnet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eth_test</span> <span class="o">=</span> <span class="n">EthereumTestnet</span><span class="p">()</span>

<span class="n">address</span> <span class="o">=</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="s1">&#39;alice_private_key&#39;</span>

<span class="n">tokens_to_swap</span> <span class="o">=</span> <span class="s1">&#39;1000&#39;</span>
<span class="n">token_address</span> <span class="o">=</span> <span class="s1">&#39;0x53E546387A0d054e7FF127923254c0a679DA6DBf&#39;</span>
</pre></div>
</div>
<p>It is also possible to get the token data directly from the network object by the token symbol if the token is supported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">token</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">get_token_by_symbol</span><span class="p">(</span><span class="s1">&#39;BBT&#39;</span><span class="p">)</span>
<span class="n">token_address</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">token_address</span>
</pre></div>
</div>
<p>Bob should initialize the network object, set his address, private key and amount of ethers to be swapped.</p>
<p>[<strong>Bob</strong>]’s console input:
from clove.network import EthereumTestnet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eth_test</span> <span class="o">=</span> <span class="n">EthereumTestnet</span><span class="p">()</span>

<span class="n">address</span> <span class="o">=</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="s1">&#39;bob_private_key&#39;</span>

<span class="n">eth_to_swap</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="communication-e1">
<span id="communication-e1"></span><h3>2. Communication (e1)<a class="headerlink" href="#communication-e1" title="Permalink to this headline">¶</a></h3>
<p>Alice and Bob exchange their wallet addresses.</p>
<p>[<strong>Alice</strong>]’s console input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_address</span> <span class="o">=</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span>
</pre></div>
</div>
<p>[<strong>Bob</strong>]’s console input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_address</span> <span class="o">=</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="token-approval">
<span id="token-approval"></span><h3>3. Token approval<a class="headerlink" href="#token-approval" title="Permalink to this headline">¶</a></h3>
<p>To send tokens to an atomic swap contract Alice has to first approve that the tokens she own can be spend by that contract.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">approve_transaction</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">approve_token</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">tokens_to_swap</span><span class="p">,</span> <span class="n">token_address</span><span class="p">)</span>
<span class="n">approve_transaction</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<span class="n">approve_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7657Ca877Fac31D20528B473162E39B6E152fd2e&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;0x095ea7b30000000000000000000000007657ca877fac31d20528b473162e39b6e152fd2e00000000000000000000000000000000000000000000003635c9adc5dea00000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gasprice&#39;</span><span class="p">:</span> <span class="mi">20000000000</span><span class="p">,</span>
 <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">112426775415197512764524506063660144184257199595961926193168166347175765778579</span><span class="p">,</span>
 <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">1927313746114385663128009448899947006587692267799486537632890580735710981604</span><span class="p">,</span>
 <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999f348959e611f1e9eab2927c21e88e48e6ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sender_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;startgas&#39;</span><span class="p">:</span> <span class="mi">45576</span><span class="p">,</span>
 <span class="s1">&#39;token_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x53E546387A0d054e7FF127923254c0a679DA6DBf&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x40b8d435ff4bfbb202aed75dfc87f64e0d3da3838581b6635ae615e0454bd4fc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1000&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;1000.000000000000000000 BBT&#39;</span><span class="p">}</span>

<span class="n">approve_transaction</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;0x40b8d435ff4bfbb202aed75dfc87f64e0d3da3838581b6635ae615e0454bd4fc&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://kovan.etherscan.io/tx/0x40b8d435ff4bfbb202aed75dfc87f64e0d3da3838581b6635ae615e0454bd4fc">Check transaction on block explorer</a></p>
</div>
<div class="section" id="alice-is-initializing-an-atomic-swap-transaction-using-bbt-token">
<span id="alice-is-initializing-an-atomic-swap-transaction-using-bbt-token"></span><h3>4. Alice is initializing an atomic swap transaction using BBT token<a class="headerlink" href="#alice-is-initializing-an-atomic-swap-transaction-using-bbt-token" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initial_transaction</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">atomic_swap</span><span class="p">(</span>
    <span class="n">sender_address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
    <span class="n">recipient_address</span><span class="o">=</span><span class="n">bob_address</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">tokens_to_swap</span><span class="p">,</span>
    <span class="n">token_address</span><span class="o">=</span><span class="n">token_address</span>
<span class="p">)</span>
<span class="n">initial_transaction</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<span class="n">initial_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7657Ca877Fac31D20528B473162E39B6E152fd2e&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;0x52f50db7000000000000000000000000000000000000000000000000000000005acde5c48cebcb1af6fa5fddeb091f61f0af1c49a6de9922000000000000000000000000000000000000000000000000d867f293ba129629a9f9355fa285b8d3711a909200000000000000000000000053e546387a0d054e7ff127923254c0a679da6dbf00000000000000000000000000000000000000000000003635c9adc5dea00000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gas_limit&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;gasprice&#39;</span><span class="p">:</span> <span class="mi">20000000000</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">535753</span><span class="p">),</span>
 <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">81080759208730988867907650750974367955166566527430658028938499115001735694910</span><span class="p">,</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">25371208205154004938960599477560107420234164093623357637201902103097079815422</span><span class="p">,</span>
 <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="s1">&#39;c037026e2d0f3901c797d2414df30a4ce700d18055925f416e575635c5c2b7ac&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;8cebcb1af6fa5fddeb091f61f0af1c49a6de9922&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999f348959e611f1e9eab2927c21e88e48e6ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sender_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;startgas&#39;</span><span class="p">:</span> <span class="mi">300000</span><span class="p">,</span>
 <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7657ca877fac31d20528b473162e39b6e152fd2e&#39;</span><span class="p">,</span>
 <span class="s1">&#39;token_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x53E546387A0d054e7FF127923254c0a679DA6DBf&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840&#39;</span><span class="p">,</span>
 <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1000&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;1000.000000000000000000 BBT&#39;</span><span class="p">}</span>

<span class="n">initial_transaction</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://kovan.etherscan.io/tx/0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840">Check transaction on block explorer</a></p>
</div>
<div class="section" id="communication-e2">
<span id="communication-e2"></span><h3>5. Communication (e2)<a class="headerlink" href="#communication-e2" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] sends hers transaction address <code class="docutils literal notranslate"><span class="pre">0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840</span></code> to Bob so he can audit created contract.</p>
</div>
<div class="section" id="contract-audit-bbt-token">
<span id="contract-audit-bbt-token"></span><h3>6. Contract audit (BBT token)<a class="headerlink" href="#contract-audit-bbt-token" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] needs to audit the contract in the network it was created in, in our case it’s Ethereum Testnet network.
And also at this point Bob should validate if the data returned in the contract is correct.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_contract</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">audit_contract</span><span class="p">(</span><span class="s1">&#39;0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840&#39;</span><span class="p">)</span>
<span class="n">alice_contract</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7657Ca877Fac31D20528B473162E39B6E152fd2e&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;8cebcb1af6fa5fddeb091f61f0af1c49a6de9922&#39;</span><span class="p">,</span>
 <span class="s1">&#39;token_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x53E546387A0d054e7FF127923254c0a679DA6DBf&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x4cc2308652423a1b05712def62fe5183dfa507bd033941bdb40b56a258760840&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1000&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;1000.000000000000000000 BBT&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="participation-eth-testnet">
<span id="participation-eth-testnet"></span><h3>7. Participation (ETH-TESTNET)<a class="headerlink" href="#participation-eth-testnet" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] has to create parallel transaction from point 4 but for 0.5 ETH. We call it <code class="docutils literal notranslate"><span class="pre">participate_transaction</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">participate_transaction</span> <span class="o">=</span> <span class="n">alice_contract</span><span class="o">.</span><span class="n">participate</span><span class="p">(</span>
    <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;ETH-TESTNET&#39;</span><span class="p">,</span>
    <span class="n">sender_address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
    <span class="n">recipient_address</span><span class="o">=</span><span class="n">alice_address</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">eth_to_swap</span>
<span class="p">)</span>

<span class="n">participate_transaction</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<span class="n">participate_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x9F7e5402ed0858Ea0C5914D44B900A42C89547B8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;0xeb8ae1ed000000000000000000000000000000000000000000000000000000005acca1d68cebcb1af6fa5fddeb091f61f0af1c49a6de9922000000000000000000000000000000000000000000000000999f348959e611f1e9eab2927c21e88e48e6ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gas_limit&#39;</span><span class="p">:</span> <span class="mi">126221</span><span class="p">,</span>
 <span class="s1">&#39;gasprice&#39;</span><span class="p">:</span> <span class="mi">20000000000</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">224171</span><span class="p">),</span>
 <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">10117394961799586109544014237169747431096329877057063230289022533801441532789</span><span class="p">,</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">34556783084242874049490624129921763496945955547455400337813271950949674389178</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;8cebcb1af6fa5fddeb091f61f0af1c49a6de9922&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293ba129629a9f9355fa285b8d3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sender_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;startgas&#39;</span><span class="p">:</span> <span class="mi">126221</span><span class="p">,</span>
 <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;0x9f7e5402ed0858ea0c5914d44b900a42c89547b8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f&#39;</span><span class="p">,</span>
 <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.500000000000000000 ETH&#39;</span><span class="p">}</span>

<span class="n">participate_transaction</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://kovan.etherscan.io/tx/0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f">Check transaction on block explorer</a></p>
</div>
<div class="section" id="communication-e3">
<span id="communication-e3"></span><h3>8. Communication (e3)<a class="headerlink" href="#communication-e3" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] sends his transaction address <code class="docutils literal notranslate"><span class="pre">0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f</span></code> to Alice.</p>
</div>
<div class="section" id="contract-audit-eth-testnet">
<span id="contract-audit-eth-testnet"></span><h3>9. Contract audit (ETH-TESTNET)<a class="headerlink" href="#contract-audit-eth-testnet" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] needs to audit the contract in the network it was created in, in our case it’s Ethereum Testnet network.
And also at this point Alice should validate if the data returned in the contract is correct.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_contract</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">audit_contract</span><span class="p">(</span>
    <span class="s1">&#39;0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f&#39;</span>
<span class="p">)</span>
<span class="n">bob_contract</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;contract_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x9F7e5402ed0858Ea0C5914D44B900A42C89547B8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;locktime&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">54</span><span class="p">),</span>
 <span class="s1">&#39;recipient_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999F348959E611F1E9eab2927c21E88E48e6Ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;refund_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293Ba129629a9f9355fa285B8D3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;secret_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;8cebcb1af6fa5fddeb091f61f0af1c49a6de9922&#39;</span><span class="p">,</span>
 <span class="s1">&#39;transaction_address&#39;</span><span class="p">:</span> <span class="s1">&#39;0xc9b2bf9b67dcfea39dea71b3416922adfcae23f6410be7d109fb9df2e1c0695f&#39;</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.500000000000000000 ETH&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="first-redeem-transaction-eth-testnet">
<span id="first-redeem-transaction-eth-testnet"></span><h3>10. First redeem transaction (ETH-TESTNET)<a class="headerlink" href="#first-redeem-transaction-eth-testnet" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Alice</strong>] can now collect coins she wants, thus she creates redeem transaction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_redeem</span> <span class="o">=</span> <span class="n">bob_contract</span><span class="o">.</span><span class="n">redeem</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">initial_transaction</span><span class="o">.</span><span class="n">show_details</span><span class="p">()[</span><span class="s1">&#39;secret&#39;</span><span class="p">])</span>
<span class="n">alice_redeem</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>

<span class="n">alice_redeem</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;0xeda1122cc037026e2d0f3901c797d2414df30a4ce700d18055925f416e575635c5c2b7ac&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gasprice&#39;</span><span class="p">:</span> <span class="mi">20000000000</span><span class="p">,</span>
 <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="s1">&#39;0x80addbc1b1ff0cf32949c78cde0dc4347f1a81e7f510fd266aa934523c92c2c1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">59319998726546023363151651169655572196637192178004534224886682741537229136353</span><span class="p">,</span>
 <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">49667378228500740364784037188336222900603288337407062594007817473604371090679</span><span class="p">,</span>
 <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;0x999f348959e611f1e9eab2927c21e88e48e6ef45&#39;</span><span class="p">,</span>
 <span class="s1">&#39;startgas&#39;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
 <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;0x9f7e5402ed0858ea0c5914d44b900a42c89547b8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;0.500000000000000000 ETH&#39;</span><span class="p">}</span>

<span class="n">alice_redeem</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;0x80addbc1b1ff0cf32949c78cde0dc4347f1a81e7f510fd266aa934523c92c2c1&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://kovan.etherscan.io/tx/0x80addbc1b1ff0cf32949c78cde0dc4347f1a81e7f510fd266aa934523c92c2c1">Check transaction on block explorer</a></p>
<p>[<strong>Alice</strong>] will get ether just after redeem transaction is published.</p>
</div>
<div class="section" id="secret-capture-eth-testnet">
<span id="secret-capture-eth-testnet"></span><h3>11. Secret capture (ETH-TESTNET)<a class="headerlink" href="#secret-capture-eth-testnet" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] should extract the secret from the redeem transaction. For this operation (<code class="docutils literal notranslate"><span class="pre">find_redeem_transaction</span></code>) an Etherscan API key is required - <a class="reference external" href="#etherscan-api-key">read more</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alice_redeem_tx_hash</span> <span class="o">=</span> <span class="n">bob_contract</span><span class="o">.</span><span class="n">find_redeem_transaction</span><span class="p">()</span>
<span class="n">secret</span> <span class="o">=</span> <span class="n">eth_test</span><span class="o">.</span><span class="n">extract_secret_from_redeem_transaction</span><span class="p">(</span><span class="n">alice_redeem_tx_hash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="second-redeem-transaction-bbt-token">
<span id="second-redeem-transaction-bbt-token"></span><h3>12. Second redeem transaction (BBT token)<a class="headerlink" href="#second-redeem-transaction-bbt-token" title="Permalink to this headline">¶</a></h3>
<p>[<strong>Bob</strong>] can now collect tokens he wants, thus he creates redeem transaction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bob_redeem</span> <span class="o">=</span> <span class="n">alice_contract</span><span class="o">.</span><span class="n">redeem</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span>
<span class="n">bob_redeem</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>

<span class="n">bob_redeem</span><span class="o">.</span><span class="n">show_details</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;0xeda1122cc037026e2d0f3901c797d2414df30a4ce700d18055925f416e575635c5c2b7ac&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gasprice&#39;</span><span class="p">:</span> <span class="mi">20000000000</span><span class="p">,</span>
 <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="s1">&#39;0x4fd41289b816f6122e59a0759bd10441ead75d550562f4b3aad2fddc56eb3274&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">65751206609566246138168255228214505208801025362644939199208252280848271690158</span><span class="p">,</span>
 <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">45667062183625152271430540771543035424773489029161348648874675951038677865195</span><span class="p">,</span>
 <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;0xd867f293ba129629a9f9355fa285b8d3711a9092&#39;</span><span class="p">,</span>
 <span class="s1">&#39;startgas&#39;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
 <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;0x7657ca877fac31d20528b473162e39b6e152fd2e&#39;</span><span class="p">,</span>
 <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1000&#39;</span><span class="p">),</span>
 <span class="s1">&#39;value_text&#39;</span><span class="p">:</span> <span class="s1">&#39;1000.000000000000000000 BBT&#39;</span><span class="p">}</span>

<span class="n">bob_redeem</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="s1">&#39;0x4fd41289b816f6122e59a0759bd10441ead75d550562f4b3aad2fddc56eb3274&#39;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://kovan.etherscan.io/tx/0x4fd41289b816f6122e59a0759bd10441ead75d550562f4b3aad2fddc56eb3274">Check transaction on block explorer</a></p>
<p>[<strong>Bob</strong>] will get BBT tokens just after redeem transaction is published.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="refund.html" class="btn btn-neutral float-right" title="Transaction refunds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="README.html" class="btn btn-neutral" title="Clove" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lamden Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>